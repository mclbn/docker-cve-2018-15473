FROM centos:7
USER root
WORKDIR /root
COPY CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.repo
RUN yum clean all
RUN yum -y update
RUN yum -y group install 'Development Tools'
RUN yum -y install zlib-devel openssl-devel wget
RUN ulimit -n 1024 && yum -y update
RUN ulimit -n 1024 && yum -y group install 'Development Tools'
RUN ulimit -n 1024 && yum -y install zlib-devel openssl-devel wget
RUN mkdir /var/lib/sshd
RUN chmod -R 700 /var/lib/sshd/
RUN chown -R root:sys /var/lib/sshd/
RUN useradd -r -U -d /var/lib/sshd/ -c "sshd privsep" -s /bin/false sshd
RUN useradd test123
RUN echo 'test123:test123' | chpasswd
RUN wget https://cdn.openbsd.org/pub/OpenBSD/OpenSSH/portable/openssh-7.3p1.tar.gz
RUN tar xvf openssh-7.3p1.tar.gz
WORKDIR /root/openssh-7.3p1
RUN ./configure && make && make install
CMD /usr/local/sbin/sshd -D
